{"ast":null,"code":"import _defineProperty from \"D:\\\\Docs\\\\Programing Projects\\\\snowline-route-manager\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"D:\\\\Docs\\\\Programing Projects\\\\snowline-route-manager\\\\client\\\\src\\\\components\\\\Auth.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from \"react\";\nimport auth0 from \"auth0-js\";\nimport { AUTH_CONFIG } from \"../auth0-variables\";\nimport { AuthProvider } from \"../authContext\";\nconst auth = new auth0.WebAuth({\n  domain: AUTH_CONFIG.domain,\n  clientID: AUTH_CONFIG.clientId,\n  redirectUri: AUTH_CONFIG.callbackUrl,\n  audience: \"https://\".concat(AUTH_CONFIG.domain, \"/userinfo\"),\n  responseType: \"token id_token\"\n});\n\nclass Auth extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      authenticated: false,\n      user: {\n        role: \"visitor\"\n      },\n      accessToken: \"\"\n    };\n\n    this.initiateLogin = () => {\n      auth.authorize();\n    };\n\n    this.logout = () => {\n      this.setState({\n        authenticated: false,\n        user: {\n          role: \"visitor\"\n        },\n        accessToken: \"\"\n      });\n    };\n\n    this.handleAuthentication = () => {\n      auth.parseHash((error, authResult) => {\n        if (error) {\n          console.log(error);\n          console.log(\"Error \".concat(error.error, \" occured\"));\n          return;\n        }\n\n        this.setSession(authResult.idTokenPayload);\n      });\n    };\n  }\n\n  setSession(data) {\n    const user = {\n      id: data.sub,\n      email: data.email,\n      role: data[AUTH_CONFIG.roleUrl]\n    };\n    this.setState({\n      authenticated: true,\n      accessToken: data.accessToken,\n      user\n    });\n  }\n\n  render() {\n    const authProviderValue = _objectSpread({}, this.state, {\n      initiateLogin: this.initiateLogin,\n      handleAuthentication: this.handleAuthentication,\n      logout: this.logout\n    });\n\n    return React.createElement(AuthProvider, {\n      value: authProviderValue,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }, this.props.children);\n  }\n\n}\n\nexport default Auth;","map":{"version":3,"sources":["D:\\Docs\\Programing Projects\\snowline-route-manager\\client\\src\\components\\Auth.js"],"names":["React","Component","auth0","AUTH_CONFIG","AuthProvider","auth","WebAuth","domain","clientID","clientId","redirectUri","callbackUrl","audience","responseType","Auth","state","authenticated","user","role","accessToken","initiateLogin","authorize","logout","setState","handleAuthentication","parseHash","error","authResult","console","log","setSession","idTokenPayload","data","id","sub","email","roleUrl","render","authProviderValue","props","children"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,OAAOC,KAAP,MAAkB,UAAlB;AAEA,SAAQC,WAAR,QAA0B,oBAA1B;AACA,SAAQC,YAAR,QAA2B,gBAA3B;AAEA,MAAMC,IAAI,GAAG,IAAIH,KAAK,CAACI,OAAV,CAAkB;AAC7BC,EAAAA,MAAM,EAAEJ,WAAW,CAACI,MADS;AAE7BC,EAAAA,QAAQ,EAAEL,WAAW,CAACM,QAFO;AAG7BC,EAAAA,WAAW,EAAEP,WAAW,CAACQ,WAHI;AAI7BC,EAAAA,QAAQ,oBAAaT,WAAW,CAACI,MAAzB,cAJqB;AAK7BM,EAAAA,YAAY,EAAE;AALe,CAAlB,CAAb;;AAQA,MAAMC,IAAN,SAAmBb,SAAnB,CAA6B;AAAA;AAAA;AAAA,SAC3Bc,KAD2B,GACnB;AACNC,MAAAA,aAAa,EAAE,KADT;AAENC,MAAAA,IAAI,EAAE;AACJC,QAAAA,IAAI,EAAE;AADF,OAFA;AAKNC,MAAAA,WAAW,EAAE;AALP,KADmB;;AAAA,SAS3BC,aAT2B,GASX,MAAM;AACpBf,MAAAA,IAAI,CAACgB,SAAL;AACD,KAX0B;;AAAA,SAa3BC,MAb2B,GAalB,MAAM;AACb,WAAKC,QAAL,CAAc;AACVP,QAAAA,aAAa,EAAE,KADL;AAEVC,QAAAA,IAAI,EAAE;AACJC,UAAAA,IAAI,EAAE;AADF,SAFI;AAKVC,QAAAA,WAAW,EAAE;AALH,OAAd;AAOD,KArB0B;;AAAA,SAuB3BK,oBAvB2B,GAuBJ,MAAM;AAC3BnB,MAAAA,IAAI,CAACoB,SAAL,CAAe,CAACC,KAAD,EAAQC,UAAR,KAAuB;AAClC,YAAID,KAAJ,EAAW;AACTE,UAAAA,OAAO,CAACC,GAAR,CAAYH,KAAZ;AACAE,UAAAA,OAAO,CAACC,GAAR,iBAAqBH,KAAK,CAACA,KAA3B;AACA;AACD;;AAED,aAAKI,UAAL,CAAgBH,UAAU,CAACI,cAA3B;AACD,OARH;AASD,KAjC0B;AAAA;;AAmC3BD,EAAAA,UAAU,CAACE,IAAD,EAAO;AACf,UAAMf,IAAI,GAAG;AACTgB,MAAAA,EAAE,EAAED,IAAI,CAACE,GADA;AAETC,MAAAA,KAAK,EAAEH,IAAI,CAACG,KAFH;AAGTjB,MAAAA,IAAI,EAAEc,IAAI,CAAC7B,WAAW,CAACiC,OAAb;AAHD,KAAb;AAKE,SAAKb,QAAL,CAAc;AACZP,MAAAA,aAAa,EAAE,IADH;AAEZG,MAAAA,WAAW,EAAEa,IAAI,CAACb,WAFN;AAGZF,MAAAA;AAHY,KAAd;AAKH;;AAEDoB,EAAAA,MAAM,GAAG;AACP,UAAMC,iBAAiB,qBAClB,KAAKvB,KADa;AAErBK,MAAAA,aAAa,EAAE,KAAKA,aAFC;AAGrBI,MAAAA,oBAAoB,EAAE,KAAKA,oBAHN;AAIrBF,MAAAA,MAAM,EAAE,KAAKA;AAJQ,MAAvB;;AAMA,WACE,oBAAC,YAAD;AAAc,MAAA,KAAK,EAAEgB,iBAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,KAAKC,KAAL,CAAWC,QADd,CADF;AAKD;;AA5D0B;;AA+D7B,eAAe1B,IAAf","sourcesContent":["import React, {Component} from \"react\";\r\nimport auth0 from \"auth0-js\";\r\n\r\nimport {AUTH_CONFIG} from \"../auth0-variables\";\r\nimport {AuthProvider} from \"../authContext\";\r\n\r\nconst auth = new auth0.WebAuth({\r\n  domain: AUTH_CONFIG.domain,\r\n  clientID: AUTH_CONFIG.clientId,\r\n  redirectUri: AUTH_CONFIG.callbackUrl,\r\n  audience: `https://${AUTH_CONFIG.domain}/userinfo`,\r\n  responseType: \"token id_token\"\r\n});\r\n\r\nclass Auth extends Component {\r\n  state = {\r\n    authenticated: false,\r\n    user: {\r\n      role: \"visitor\"\r\n    },\r\n    accessToken: \"\"\r\n  };\r\n\r\n  initiateLogin = () => {\r\n    auth.authorize();\r\n  };\r\n\r\n  logout = () => {\r\n    this.setState({\r\n        authenticated: false,\r\n        user: {\r\n          role: \"visitor\"\r\n        },\r\n        accessToken: \"\"\r\n      });\r\n  };\r\n\r\n  handleAuthentication = () => {\r\n    auth.parseHash((error, authResult) => {\r\n        if (error) {\r\n          console.log(error);\r\n          console.log(`Error ${error.error} occured`);\r\n          return;\r\n        }\r\n    \r\n        this.setSession(authResult.idTokenPayload);\r\n      });\r\n  };\r\n\r\n  setSession(data) {\r\n    const user = {\r\n        id: data.sub,\r\n        email: data.email,\r\n        role: data[AUTH_CONFIG.roleUrl]\r\n      };\r\n      this.setState({\r\n        authenticated: true,\r\n        accessToken: data.accessToken,\r\n        user\r\n      });\r\n  }\r\n\r\n  render() {\r\n    const authProviderValue = {\r\n      ...this.state,\r\n      initiateLogin: this.initiateLogin,\r\n      handleAuthentication: this.handleAuthentication,\r\n      logout: this.logout\r\n    };\r\n    return (\r\n      <AuthProvider value={authProviderValue}>\r\n        {this.props.children}\r\n      </AuthProvider>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Auth;"]},"metadata":{},"sourceType":"module"}