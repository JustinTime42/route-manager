{"ast":null,"code":"import _defineProperty from\"D:\\\\Docs\\\\Programing Projects\\\\snowline-route-manager\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _classCallCheck from\"D:\\\\Docs\\\\Programing Projects\\\\snowline-route-manager\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\Docs\\\\Programing Projects\\\\snowline-route-manager\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"D:\\\\Docs\\\\Programing Projects\\\\snowline-route-manager\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"D:\\\\Docs\\\\Programing Projects\\\\snowline-route-manager\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"D:\\\\Docs\\\\Programing Projects\\\\snowline-route-manager\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React,{Component}from\"react\";import auth0 from\"auth0-js\";import{AUTH_CONFIG}from\"../auth0-variables\";import{AuthProvider}from\"../authContext\";var auth=new auth0.WebAuth({domain:AUTH_CONFIG.domain,clientID:AUTH_CONFIG.clientId,redirectUri:AUTH_CONFIG.callbackUrl,audience:\"https://\".concat(AUTH_CONFIG.domain,\"/userinfo\"),responseType:\"token id_token\"});var Auth=/*#__PURE__*/function(_Component){_inherits(Auth,_Component);function Auth(){var _getPrototypeOf2;var _this;_classCallCheck(this,Auth);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(Auth)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={authenticated:false,user:{role:\"visitor\"},accessToken:\"\"};_this.initiateLogin=function(){auth.authorize();};_this.logout=function(){_this.setState({authenticated:false,user:{role:\"visitor\"},accessToken:\"\"});};_this.handleAuthentication=function(){auth.parseHash(function(error,authResult){if(error){console.log(error);console.log(\"Error \".concat(error.error,\" occured\"));return;}_this.setSession(authResult.idTokenPayload);});};return _this;}_createClass(Auth,[{key:\"setSession\",value:function setSession(data){var user={id:data.sub,email:data.email,role:data[AUTH_CONFIG.roleUrl]};this.setState({authenticated:true,accessToken:data.accessToken,user:user});}},{key:\"render\",value:function render(){var authProviderValue=_objectSpread({},this.state,{initiateLogin:this.initiateLogin,handleAuthentication:this.handleAuthentication,logout:this.logout});return React.createElement(AuthProvider,{value:authProviderValue},this.props.children);}}]);return Auth;}(Component);export default Auth;","map":{"version":3,"sources":["D:\\Docs\\Programing Projects\\snowline-route-manager\\client\\src\\components\\Auth.js"],"names":["React","Component","auth0","AUTH_CONFIG","AuthProvider","auth","WebAuth","domain","clientID","clientId","redirectUri","callbackUrl","audience","responseType","Auth","state","authenticated","user","role","accessToken","initiateLogin","authorize","logout","setState","handleAuthentication","parseHash","error","authResult","console","log","setSession","idTokenPayload","data","id","sub","email","roleUrl","authProviderValue","props","children"],"mappings":"8oDAAA,MAAOA,CAAAA,KAAP,EAAeC,SAAf,KAA+B,OAA/B,CACA,MAAOC,CAAAA,KAAP,KAAkB,UAAlB,CAEA,OAAQC,WAAR,KAA0B,oBAA1B,CACA,OAAQC,YAAR,KAA2B,gBAA3B,CAEA,GAAMC,CAAAA,IAAI,CAAG,GAAIH,CAAAA,KAAK,CAACI,OAAV,CAAkB,CAC7BC,MAAM,CAAEJ,WAAW,CAACI,MADS,CAE7BC,QAAQ,CAAEL,WAAW,CAACM,QAFO,CAG7BC,WAAW,CAAEP,WAAW,CAACQ,WAHI,CAI7BC,QAAQ,mBAAaT,WAAW,CAACI,MAAzB,aAJqB,CAK7BM,YAAY,CAAE,gBALe,CAAlB,CAAb,C,GAQMC,CAAAA,I,uXACJC,K,CAAQ,CACNC,aAAa,CAAE,KADT,CAENC,IAAI,CAAE,CACJC,IAAI,CAAE,SADF,CAFA,CAKNC,WAAW,CAAE,EALP,C,OAQRC,a,CAAgB,UAAM,CACpBf,IAAI,CAACgB,SAAL,GACD,C,OAEDC,M,CAAS,UAAM,CACb,MAAKC,QAAL,CAAc,CACVP,aAAa,CAAE,KADL,CAEVC,IAAI,CAAE,CACJC,IAAI,CAAE,SADF,CAFI,CAKVC,WAAW,CAAE,EALH,CAAd,EAOD,C,OAEDK,oB,CAAuB,UAAM,CAC3BnB,IAAI,CAACoB,SAAL,CAAe,SAACC,KAAD,CAAQC,UAAR,CAAuB,CAClC,GAAID,KAAJ,CAAW,CACTE,OAAO,CAACC,GAAR,CAAYH,KAAZ,EACAE,OAAO,CAACC,GAAR,iBAAqBH,KAAK,CAACA,KAA3B,cACA,OACD,CAED,MAAKI,UAAL,CAAgBH,UAAU,CAACI,cAA3B,EACD,CARH,EASD,C,8EAEUC,I,CAAM,CACf,GAAMf,CAAAA,IAAI,CAAG,CACTgB,EAAE,CAAED,IAAI,CAACE,GADA,CAETC,KAAK,CAAEH,IAAI,CAACG,KAFH,CAGTjB,IAAI,CAAEc,IAAI,CAAC7B,WAAW,CAACiC,OAAb,CAHD,CAAb,CAKE,KAAKb,QAAL,CAAc,CACZP,aAAa,CAAE,IADH,CAEZG,WAAW,CAAEa,IAAI,CAACb,WAFN,CAGZF,IAAI,CAAJA,IAHY,CAAd,EAKH,C,uCAEQ,CACP,GAAMoB,CAAAA,iBAAiB,kBAClB,KAAKtB,KADa,EAErBK,aAAa,CAAE,KAAKA,aAFC,CAGrBI,oBAAoB,CAAE,KAAKA,oBAHN,CAIrBF,MAAM,CAAE,KAAKA,MAJQ,EAAvB,CAMA,MACE,qBAAC,YAAD,EAAc,KAAK,CAAEe,iBAArB,EACG,KAAKC,KAAL,CAAWC,QADd,CADF,CAKD,C,kBA5DgBtC,S,EA+DnB,cAAea,CAAAA,IAAf","sourcesContent":["import React, {Component} from \"react\";\r\nimport auth0 from \"auth0-js\";\r\n\r\nimport {AUTH_CONFIG} from \"../auth0-variables\";\r\nimport {AuthProvider} from \"../authContext\";\r\n\r\nconst auth = new auth0.WebAuth({\r\n  domain: AUTH_CONFIG.domain,\r\n  clientID: AUTH_CONFIG.clientId,\r\n  redirectUri: AUTH_CONFIG.callbackUrl,\r\n  audience: `https://${AUTH_CONFIG.domain}/userinfo`,\r\n  responseType: \"token id_token\"\r\n});\r\n\r\nclass Auth extends Component {\r\n  state = {\r\n    authenticated: false,\r\n    user: {\r\n      role: \"visitor\"\r\n    },\r\n    accessToken: \"\"\r\n  };\r\n\r\n  initiateLogin = () => {\r\n    auth.authorize();\r\n  };\r\n\r\n  logout = () => {\r\n    this.setState({\r\n        authenticated: false,\r\n        user: {\r\n          role: \"visitor\"\r\n        },\r\n        accessToken: \"\"\r\n      });\r\n  };\r\n\r\n  handleAuthentication = () => {\r\n    auth.parseHash((error, authResult) => {\r\n        if (error) {\r\n          console.log(error);\r\n          console.log(`Error ${error.error} occured`);\r\n          return;\r\n        }\r\n    \r\n        this.setSession(authResult.idTokenPayload);\r\n      });\r\n  };\r\n\r\n  setSession(data) {\r\n    const user = {\r\n        id: data.sub,\r\n        email: data.email,\r\n        role: data[AUTH_CONFIG.roleUrl]\r\n      };\r\n      this.setState({\r\n        authenticated: true,\r\n        accessToken: data.accessToken,\r\n        user\r\n      });\r\n  }\r\n\r\n  render() {\r\n    const authProviderValue = {\r\n      ...this.state,\r\n      initiateLogin: this.initiateLogin,\r\n      handleAuthentication: this.handleAuthentication,\r\n      logout: this.logout\r\n    };\r\n    return (\r\n      <AuthProvider value={authProviderValue}>\r\n        {this.props.children}\r\n      </AuthProvider>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Auth;"]},"metadata":{},"sourceType":"module"}